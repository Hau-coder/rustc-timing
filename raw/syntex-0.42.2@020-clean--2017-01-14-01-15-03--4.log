commit 6fe23719feb20c25a8b2693d1f196e72d8da9af5
Merge: b13cc05 c6f99b4
Author: bors <bors@rust-lang.org>
Date:   Sat Jan 14 06:43:03 2017 +0000

    Auto merge of #38914 - est31:tidy-gate-tests, r=nikomatsakis
    
    Make tidy check for lang gate tests
    
    Add gate tests to the checks that tidy performs. Excerpt from the commit message of the main commit:
    
        Require compile-fail tests for new lang features
    
        Its non trivial to test lang feature gates, and people
        forget to add such tests. So we extend the features lint
        of the tidy tool to ensure that all new lang features
        contain a new compile-fail test.
    
        Of course, one could drop this requirement and just
        grep all tests in run-pass for #![feature(abc)] and
        then run this test again, removing the mention,
        requiring that it fails.
    
        But this only tests for the existence of a compilation
        failure. Manual tests ensure that also the correct lines
        spawn the error, and also test the actual error message.
    
        For library features, it makes no sense to require such
        a test, as here code is used that is generic for all
        library features.
    
    The tidy lint extension now checks the compile-fail test suite for occurences of "gate-test-X" where X is a feature. Alternatively, it also accepts file names with the form "feature-gate-X.rs". If a lang feature is found that has no such check, we emit a tidy error.
    
    I've applied the markings to all tests I could find in the test suite. I left a small (20 elements) whitelist of features that right now have no gate test, or where I couldn't find one. Once this PR gets merged, I'd like to close issue #22820 and open a new one on suggestion of @nikomatsakis to track the removal of all elements from that whitelist (already have a draft). Writing such a small test can be a good opportunity for a first contribution, so I won't touch it (let others have the fun xD).
    
    cc @brson , @pnkfelix (they both discussed about this in the issue linked above).
rustc 1.15.0-nightly (daf8c1dfc 2016-12-05)
-rwxr-xr-x 1 root root 9432 Dec  6 15:39 /usr/local/bin/rustc
rustc: ./syntex-0.42.2@020-clean
find . -name '*.rs' | xargs touch
RUSTFLAGS="-Z incremental=incr" \
    cargo rustc -p syntex_syntax  -- \
    -Ztime-passes -Zinput-stats -Z incremental-info
makefile:14: recipe for target 'all@020-clean' failed
done
